/*!-- all javascript --*/

/* header.js */ document.querySelector(".header")&&(()=>{let e=document.querySelector(".header"),t=0;window.addEventListener("scroll",()=>{let l=scrollY;e.classList.toggle("pin",l>160&&l>t),e.classList.toggle("pinX",l>160),t=l})})();

/* seacrh.js */ if(null!==document.querySelector(".BlogSearch")){let e=document.querySelectorAll(".BlogSearch .buttons span"),t=document.querySelector(".BlogSearch .shortIi");e.forEach(a=>{a.addEventListener("click",()=>{e.forEach(e=>e.classList.remove("selected")),a.classList.add("selected");let l=a.getAttribute("data-text");t.setAttribute("data-text",l);let c=a.getAttribute("data-value");t.setAttribute("data-value",c),document.querySelector(".BlogSearch input.shortI").checked=!1,document.getElementById("search-action").focus()})}),document.getElementById("search-form").addEventListener("submit",function(e){var a=document.getElementById("search-action").value,l=t.getAttribute("data-value");l&&(a+=" label:"+l),document.getElementById("search-action").value=a});let a=document.querySelectorAll(".BSAction"),l=document.querySelector("#search-action"),c=document.querySelector(".BlogSearch"),r=!1;a.forEach(e=>{e.addEventListener("click",()=>{r?(l.blur(),c.classList.remove("focus")):(l.focus(),c.classList.add("focus")),r=!r})});let s=document.getElementById("search-action"),d=document.getElementById("result-span");d.addEventListener("click",()=>{d.classList.add("hidden")}),s.addEventListener("input",()=>{""!==s.value.trim()?d.classList.remove("hidden"):d.classList.add("hidden")})}

/* timeago.js */ document.querySelector("time")&&(()=>{function t(e){let t=new Date,n=new Date(e),r=Math.floor((t-n)/1e3);for(let t of[{s:31536e3,l:["year","years"]},{s:2592e3,l:["month","months"]},{s:604800,l:["week","weeks"]},{s:86400,l:["day","days"]},{s:3600,l:["hour","hours"]},{s:60,l:["minute","minutes"]},{s:1,l:["second","seconds"]}]){let n=Math.floor(r/t.s);if(n>=1)return`${n} ${1===n?t.l[0]:t.l[1]} ago`}return"just now"}function n(){document.querySelectorAll("time").forEach(e=>{e.textContent=t(e.getAttribute("datetime"))})}n(),setInterval(n,1e3)})();

/* info.js */ if(null!==document.querySelector("#speak")){let e=document.getElementById("speak"),t=document.getElementById("speakText"),l,n=!1;function r(e){let t="",l=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){let t=e.parentNode.tagName.toLowerCase();return"script"===t||"style"===t?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},!1);for(;l.nextNode();)t+=l.currentNode.nodeValue.trim()+" ";return t.trim()}e.addEventListener("click",()=>{if(n)speechSynthesis.cancel(),e.classList.remove("play"),n=!1;else{let o=r(t);o&&((l=new SpeechSynthesisUtterance(o)).onend=()=>{e.classList.remove("play"),n=!1},speechSynthesis.speak(l),e.classList.add("play"),n=!0)}})}if(null!==document.querySelector("#read-time")){function o(e){let t="",l=e.childNodes.length;for(let n=0;n<l;n++){let r=e.childNodes[n];8!==r.nodeType&&(t+=1!==r.nodeType?r.nodeValue:o(r))}return t}let a=Math.round(o(document.querySelector(".docs")).split(" ").length/200),d;d=0===a||1===a?"minute":"minutes",document.getElementById("read-time").innerHTML=`${a} ${d}`}if(null!==document.querySelector(".copyShare")){let t=document.querySelector(".copyShare");t.addEventListener("click",function(){let t=this.getAttribute("data-url");navigator.clipboard.writeText(t).then(()=>{let t=this.querySelector("span"),e=t.textContent;t.textContent="Link was copied",setTimeout(()=>{t.textContent=e},1e3)})})}

/* book.js */ function updateSaveButtons(t){let e=document.querySelectorAll(`.save-this[data-postId='${t}']`),o=(JSON.parse(localStorage.getItem("bookmarkedPosts"))||[]).includes(t);e.forEach(t=>{o?t.classList.add("saved"):t.classList.remove("saved")})}function loadSavedPosts(){(JSON.parse(localStorage.getItem("bookmarkedPosts"))||[]).forEach(t=>updateSaveButtons(t)),updateBookmarkCount()}function updateBookmarkCount(){let t=JSON.parse(localStorage.getItem("bookmarkedPosts"))||[];document.getElementById("post-count").setAttribute("data-text",t.length)}function initializeSaveButtons(){document.querySelectorAll(".save-this").forEach(t=>{t.addEventListener("click",()=>{let e=t.getAttribute("data-postId"),o=JSON.parse(localStorage.getItem("bookmarkedPosts"))||[],a=o.indexOf(e);-1===a?o.push(e):o.splice(a,1),localStorage.setItem("bookmarkedPosts",JSON.stringify(o)),updateSaveButtons(e),updateBookmarkCount()})})}initializeSaveButtons(),loadSavedPosts();let paginationButton=document.querySelector(".pagination .button");null!==paginationButton&&paginationButton.addEventListener("click",function(){let t=this,e=t.getAttribute("data-action");e?(t.classList.add("loading"),fetch(e).then(t=>t.text()).then(e=>{let o=new DOMParser().parseFromString(e,"text/html"),a=Array.from(o.querySelectorAll(".stories.grid article")).map(t=>t.outerHTML).join("");document.querySelector(".stories.grid").innerHTML+=a;let i=o.querySelector(".pagination .button[data-action]")?.getAttribute("data-action");i?t.setAttribute("data-action",i):document.querySelector(".pagination")?.setAttribute("hidden","true"),t.classList.remove("loading"),initializeSaveButtons(),loadSavedPosts(),"function"==typeof loadClickCounts&&loadClickCounts()}).catch(e=>{t.classList.remove("loading"),console.error("Error loading new posts:",e)})):document.querySelector(".pagination")?.setAttribute("hidden","true")});

/* like-count.js */ if(null!==document.querySelector(".likeI")){const t={blogID:"BLOG",databaseUrl:"https://like-count-2afb6-default-rtdb.firebaseio.com/",abbreviation:!0};function abvr(t){const e=Math.sign(Number(t));return Math.abs(t)>=1e9?e*(Math.abs(t)/1e9).toFixed(2)+"B":Math.abs(t)>=1e6?e*(Math.abs(t)/1e6).toFixed(2)+"M":Math.abs(t)>=1e3?e*(Math.abs(t)/1e3).toFixed(2)+"K":Math.abs(t)}function loadClickCounts(){const e=document.querySelectorAll(".likeI"),a=firebase.database();for(let i=0;i<e.length;i++){const o=e[i],s=o.getAttribute("data-id"),n=JSON.parse(localStorage.getItem("clickedPosts"))||{};a.ref(`BlogID_${t.blogID}/PostID_${s}/clicks`).once("value",(e=>{const a=e.exists()?e.val():0;o.setAttribute("data-text",t.abbreviation?abvr(a):a),o.classList.remove("hidden"),n[s]&&o.classList.add("clicked")}))}}function incrementClickCount(e){const a=firebase.database(),i=e.getAttribute("data-id"),o=a.ref(`BlogID_${t.blogID}/PostID_${i}/clicks`),s=JSON.parse(localStorage.getItem("clickedPosts"))||{};o.once("value",(a=>{let n=a.exists()?a.val():0;n++,o.set(n).then((()=>{e.setAttribute("data-text",t.abbreviation?abvr(n):n),s[i]||(e.classList.add("clicked"),s[i]=!0,localStorage.setItem("clickedPosts",JSON.stringify(s)))}))}))}function loadScript(t,e,a=!0){return new Promise(((i,o)=>{if(e&&document.getElementById(e))return void i();const s=document.createElement("script");e&&(s.id=e),s.src=t,s.async=a,s.onload=()=>i(),s.onerror=()=>o(Error(`Failed to load script: ${t}`)),document.head.appendChild(s)}))}function initFirebaseAndLikes(){loadScript("https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js").then((()=>loadScript("https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"))).then((()=>{firebase.initializeApp({databaseURL:t.databaseUrl}),"function"==typeof loadClickCounts&&loadClickCounts()}))}const e=["keydown","mouseover","touchmove","touchstart"],a="hasInteractedBefore";function handleFirstInteraction(){localStorage.getItem(a)||localStorage.setItem(a,"true"),initFirebaseAndLikes(),e.forEach((t=>window.removeEventListener(t,handleFirstInteraction)))}localStorage.getItem(a)?initFirebaseAndLikes():e.forEach((t=>window.addEventListener(t,handleFirstInteraction,{once:!0})))}

/* forYou.js */ const forYouElement=document.querySelector(".forYou");if(forYouElement){let e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){let l=document.querySelector(".info .x .n a"),o=l?.dataset?.label;o&&(fetch(`/feeds/posts/default/-/${o}?alt=json`).then(e=>e.json()).then(e=>{let t=(e.feed.entry||[]).map(e=>{let t=e.title.$t,l=e.link.find(e=>"alternate"===e.rel).href,o=e.media$thumbnail?e.media$thumbnail.url.replace(/\/s\d+\-c\//,"/s300-c/"):"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj7gSvkTm6-PuGZ2ni5DCI8oGcunBYrCBSvAJvZ0s881WWOmbP2F2T2j9gYpEDpiGNqipehIA46Eb0WEZqYwC8nH3LEz6zQPNnzcS9vGkaMFZq21Y8kGPvQhsI4qWxjvqKL5b-fSjVmD8P9GJli-aOyv4b9rYPCrjWsH1NFrZN8K8U_ett_MFiSBhkaemAW/s1600/noImage.png";return{title:t,link:l,img:o}});for(let l=t.length-1;l>0;l--){let o=Math.floor(Math.random()*(l+1));[t[l],t[o]]=[t[o],t[l]]}let r=t.slice(0,4),n="";r.forEach(e=>{n+=`<article class='flex align-center'><a class='nolight' href='${e.link}'><img src='${e.img}' alt='${e.title}' loading='lazy' width='65' height='65'/></a><h2 class='pFont fontsize16'><a href='${e.link}' rel="bookmark">${e.title}</a></h2></article>`}),forYouElement.innerHTML=n}).catch(e=>{console.error("Failed to fetch posts:",e),forYouElement.innerHTML="<div class='error'>Could not load related posts.</div>"}),t.unobserve(forYouElement))}})},{threshold:.1});e.observe(forYouElement)}

/* bookpost.js */ const emptyMsgHTML=`<p class="PI sColor">It looks like you haven't added anything yet. Don't leave this blank, <span class="fontw500 pColor">add your favorite articles now.</span></p><a class='button big r gap16 fontw500 fontsize13 nolight' href='/'><span>Let&#39;s add one!</span><span class='mask arrow-right'/></a>`;function loadBookmarkedPosts(){const e=document.getElementById("postContainer");if(!e)return;const t=JSON.parse(localStorage.getItem("bookmarkedPosts"))||[];if(0===t.length){e.innerHTML=emptyMsgHTML;return}Promise.all(t.map(t=>fetch(`/feeds/posts/default/${t}?alt=json`).then(e=>e.json()))).then(t=>{const n=t.filter(e=>e);0===n.length?e.innerHTML=emptyMsgHTML:renderPosts(n)}).catch(()=>{e.innerHTML=emptyMsgHTML})}function renderPosts(e){const t=document.getElementById("postContainer");t.innerHTML="",e.forEach(e=>{const n=e.entry,r=n.title.$t,o=n.link.find(e=>"alternate"===e.rel).href,a=n.media$thumbnail?n.media$thumbnail.url.replace(/\/s\d+\-c\//,"/s300-c/"):"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj7gSvkTm6-PuGZ2ni5DCI8oGcunBYrCBSvAJvZ0s881WWOmbP2F2T2j9gYpEDpiGNqipehIA46Eb0WEZqYwC8nH3LEz6zQPNnzcS9vGkaMFZq21Y8kGPvQhsI4qWxjvqKL5b-fSjVmD8P9GJli-aOyv4b9rYPCrjWsH1NFrZN8K8U_ett_MFiSBhkaemAW/s1600/noImage.png",i=n.id.$t.split(".post-").pop(),l=document.createElement("article");l.className="bookmark-post inheritcolor",l.innerHTML=`<div class='img'><a class='nolight' href="${o}" aria-label="Thumbnail"><img src="${a}" loading='lazy' width='65' height='65' alt="${r}"></a></div><div class="titleI"><h2><a href="${o}" rel="bookmark">${r}</a></h2></div><div class="deleteBtn flex place-center" data-postId="${i}"><svg class="line" viewBox="0 0 24 24"><path d="M 18.645 9.251 L 18.649 12.575 M 17.667 19.142 L 15.545 17.021 M 15.544 21.263 L 17.667 19.142 M 19.788 17.021 L 17.667 19.142 M 17.666 19.142 L 19.787 21.263 M 8.625 5.217 L 15.375 5.217 M 4.212 5.217 L 8.821 5.217 M 19.788 5.217 L 15.179 5.217 M 8.625 5.203 L 8.625 4.19 C 8.625 3.085 9.52 2.19 10.625 2.19 L 13.375 2.19 C 14.479 2.19 15.375 3.085 15.375 4.19 L 15.375 5.203 M 10.844 21.263 L 7.53 21.263 C 6.454 21.263 5.532 20.618 5.346 19.735 L 5.355 9.251"></path></svg></div>`,t.appendChild(l),l.querySelector(".deleteBtn").addEventListener("click",()=>{deletePost(i)})})}function deletePost(e){let t=JSON.parse(localStorage.getItem("bookmarkedPosts"))||[];t=t.filter(t=>t!==e),localStorage.setItem("bookmarkedPosts",JSON.stringify(t));let n=document.querySelector(`.deleteBtn[data-postId='${e}']`)?.closest(".bookmark-post");n?.remove(),updateBookmarkCount();0===t.length&&(document.getElementById("postContainer").innerHTML=emptyMsgHTML)}const observer=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){loadBookmarkedPosts(),t.unobserve(e.target)}})},{rootMargin:"200px"}),container=document.querySelector("#postContainer");container&&observer.observe(container);

/* cookie.js */ let body=document.querySelector("body"),cookieBox=document.createElement("div");function setCookie(e,o,t){document.cookie=`${e}=${o}; max-age=${t}; path=/`}function getCookie(e){return document.cookie.split("; ").find(o=>o.startsWith(e+"="))?.split("=")[1]}function showCookieBanner(){getCookie("cookieConsent")||(cookieBox.classList.add("cookie","flex","column"),cookieBox.insertAdjacentHTML("beforeend",`<p class="fontsize14 LS">We use cookies to understand preferences and optimize your experience using our site, this includes advertising affiliated with Google.</p><div class="flex align-center"><a class="button noH extralink nolight" href="https://policies.google.com/technologies/cookies" rel="nofollow noreferrer" target="_blank">Learn more</a><button class="accept button r noH noC black nolight">OK, got it.</button></div>`),body.prepend(cookieBox),cookieBox.querySelector(".accept").addEventListener("click",()=>{setCookie("cookieConsent","true",2592e3),cookieBox.remove()}))}let triggered=!1;function initOnInteraction(){triggered||(triggered=!0,showCookieBanner(),["keydown","mouseover","touchmove","touchstart"].forEach(e=>window.removeEventListener(e,initOnInteraction)))}["keydown","mouseover","touchmove","touchstart"].forEach(e=>window.addEventListener(e,initOnInteraction,{once:!0}));
